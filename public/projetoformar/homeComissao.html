<!DOCTYPE html>
<html>
    <head>
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<meta name="viewport" content="width=device-width, initial-scale=1">
		
		<script src="js/jquery-1.10.1.min.js"></script>
		<script src="js/jquery-migrate-1.2.1.min.js"></script>
		
		<link rel="stylesheet" href="css/jquery.mobile-1.4.0.min.css" />
		<script src="js/jquery.mobile-1.4.0.min.js"></script>
		
		<script src="js/herbiee.js"></script>
		
		<link rel="stylesheet" href="css/jquery.rateyo.min.css"/>
		<script src="js/jquery.rateyo.min.js"></script>		

        <title>Projeto FORMAR</title>        

    </head>
    
	<style>
	
		.ui-panel-inner {
			padding: 0px; 
		}
		
		input[type=number]::-webkit-inner-spin-button, 
		input[type=number]::-webkit-outer-spin-button { 
	  		-webkit-appearance: none; 
	  		margin: 0; 
		}	
	
	</style>    
	
	<body>
	
	<!-- Page starts here -->
		<div data-role="page" data-theme="a" id="page1">

		<div data-role="panel" id="menu" data-position="left" data-display="push" data-dismissible="true" style="background-color: #33B5E5;padding: 0px">
			
			<div><img src="img/fundo_menu.png" style="width: 100%; height: 120px"></div>
			<div><img src="img/user.png" style="margin-left:5px; width: 40px;position: absolute; top: 10px;"></div>
			<div id="emailUsuario" style="font-size: 14px; text-shadow: none; margin-left: 5px; font-weight: bold; position: absolute; top: 80px;" ></div>			
			<div id="perfilSelecionado" style="font-size: 14px; text-shadow: none; margin-left: 5px; font-weight: bold; position: absolute; top: 100px;" ></div>
			<div style="margin: 5px">
				<a data-role="button" data-icon="home" data-position-to="window" href="#" onclick="$(window).attr('location', 'homeComissao.html');" style="text-align: left;background-color: yellow">Home</a>
				<a data-role="button" data-icon="user" data-position-to="window" href="#" onclick="$(window).attr('location', 'meusDadosComissao.html');" style="text-align: left;" >Meus Dados</a>
				<a data-role="button" data-icon="gear" data-position-to="window" href="#" onclick="$(window).attr('location', 'selecionarPerfil.html?ok=1');" style="text-align: left;">Perfil</a>			
				<a data-role="button" data-icon="power" data-position-to="window" href="#" onclick="$(window).attr('location','login.html?frommenu=1');" style="text-align: left;">Sair</a>
			</div>
			
		</div>
		<!-- menu  -->
		
		<!-- home -->
		<div data-role="panel" id="home" data-position="right" data-display="push" data-dismissible="true" data-theme="a" style="background-color: #a50a0c;padding: 0px">
			
				<div><img src="img/fundo_eventos.png" style="width: 100%; height: 100px"></div>
				
				<div style="margin: 5px">
					  
					  <div class="ui-corner-all" align="center">
					    <font color="white" size="5px" style="text-shadow: none;"><b>Notificações</b></font>
					  </div>
					  
					  <br/>
					  
					  <ul id="eventoRecente" data-inset="true" data-role="listview">
					  </ul>
					  
				</div>
			
		</div>
		<!-- home  -->		
		
		<div data-role="header" id="hdrMain" name="hdrMain" data-theme="a">
			<h1 id="tituloPagina" style="margin: 0">Projeto FORMAR <br/> Comissão</h1>
			<a href="#menu" data-icon="bars" data-iconpos="notext" data-rel="dialog" data-transition="fade">Menu</a>
			<a id="btHome" href="#home" data-icon="bullets" data-iconpos="notext" data-direction="reverse" data-transition="fade">Home</a>			
		</div>
		
		<!-- contentMain -->
		<div align="CENTER" data-role="content" id="contentDialog" name="contentDialog">
			<div data-role="header" data-nobackbtn="false">
				<h1>Projeto FORMAR</h1>
			</div>
			<br/>
			<b><font color="red"><div id="msgServerErro" style="font-size: 20px;padding: 1em"></div></font></b>
			<br/>
			<a id="buttonOK" name="buttonOK" href="#page1" data-role="button" data-inline="true" style="width: 100px" data-theme="b">OK</a>
		</div>
		
		<div align="CENTER" data-role="content" id="contentDialog2" name="contentDialog2">
			<div data-role="header" data-nobackbtn="false">
				<h1>Projeto FORMAR</h1>
			</div>
			<br/>
			<b><font color="blue"><div id="msgServer" style="font-size: 20px;padding: 1em"></div></font></b>
			<br/>
			<a id="buttonOK2" name="buttonOK2" href="#page1" data-role="button" data-inline="true" style="width: 100px" data-theme="b">OK</a>
		</div>
		
		<div align="CENTER" data-role="content" id="contentDialogConfirmacaoExclusao" name="contentDialogConfirmacaoExclusao">
			<div data-role="header" data-nobackbtn="false">
				<h1>Projeto FORMAR</h1>
			</div>
			<br/>		
			<div id="msgServer2" style="font-size: 20px;padding: 1em"></div>
				<table width="100%" style="padding: 10px">
					<tr>
						<td width="50%" align="right"><a id="buttonNao" name="buttonNao" href="#page1" data-role="button" data-inline="true" style="width: 80px">Não</a></td>
						<td width="50%" align="left"><a id="buttonSim" name="buttonSim" onclick="confirmarExclusao()" data-role="button" data-inline="true" data-theme="b" style="width: 80px">Sim</a></td>
					</tr>
				</table>			
		</div>
		
		<div align="CENTER" data-role="content" id="contentDialogConfirmacao1" name="contentDialogConfirmacao1">
			<div data-role="header" data-nobackbtn="false">
				<h1>Projeto FORMAR</h1>
			</div>
			<br/>		
			<div id="msgServer_1" style="font-size: 20px;padding: 1em"></div>
				<table width="100%" style="padding: 10px">
					<tr>
						<td width="50%" align="right"><a id="buttonCancelar" name="buttonCancelar1" href="#page1" data-role="button" data-inline="true" style="width: 80px">Cancelar</a></td>
						<td width="50%" align="left"><a id="buttonSim1" name="buttonSim1" onclick="callBackTelaConfirmacao()" data-role="button" data-inline="true" data-theme="b" style="width: 80px">Confirmar</a></td>
					</tr>
				</table>			
		</div>		
		
		<div align="CENTER" data-role="content" id="contentDialogConfirmacao2" name="contentDialogConfirmacao2">
			<div data-role="header" data-nobackbtn="false">
				<h1>Projeto FORMAR</h1>
			</div>
			<br/>		
			<div id="msgServer_2" style="font-size: 20px;padding: 1em"></div>
				<table width="100%" style="padding: 10px">
					<tr>
						<td width="50%" align="right"><a id="buttonCancelar2" name="buttonCancelar2" href="#page1" data-role="button" data-inline="true" style="width: 80px">Cancelar</a></td>
						<td width="50%" align="left"><a id="buttonSim2" name="buttonSim2" onclick="confirmarIngressoComissao()" data-role="button" data-inline="true" data-theme="b" style="width: 80px">Continuar</a></td>
					</tr>
				</table>			
		</div>					
		
		<!-- contentDialog -->
		<!-- contentTransition is displayed after the form is submitted until a response is received back. -->
		<div data-role="content" id="contentTransition" name="contentTransition">
			<div align="CENTER"><h4>Aguarde por favor...</h4></div>
			<div align="CENTER"><img id="spin" name="spin" src="img/progress_bar.gif"/></div>
		</div> <!-- contentTransition -->		

		<div data-role="content" id="contentMain" name="contentMain">
		
			<div id="midia" style="background-color: white;height: 150px;margin-left: -1em;margin-top: -1em; margin-right: -1em; margin-bottom: 1em"></div>

			<!-- <div style="padding: 1em;background-color: #e9e9e9" class="ui-bar-c ui-corner-all ui-shadow"> -->
				<!-- <label for="grid"><b>Detalhes:</b></label> -->
				<ul id="grid" data-role="listview" data-filter-placeholder="Pesquisar..." data-inset="true">		
				</ul>
			<!-- </div> -->
			
			<div style="padding: 1em;background-color: #e9e9e9;max-height: 300px" class="ui-bar-c ui-corner-all ui-shadow">
				<label for="noticias"><b>Feed de Notícias</b></label>
				<ul id="noticias" data-role="listview" data-filter-placeholder="Pesquisar..." data-inset="true">		
				</ul>
			</div>
			<br/>
			<div style="padding: 1em;background-color: #e9e9e9" class="ui-bar-c ui-corner-all ui-shadow">
				<label for="gridMembros"><b>Membros</b></label>
				<ul id="gridMembros" data-role="listview" data-filter-placeholder="Pesquisar..." data-inset="true">		
				</ul>
				<div id="divBtAdicionarMembro" style="display: none"><input width="100%" id="btnAdicionarMembro" onclick="" type="button" value="Adicionar" data-theme="b"/></div>
			</div>			
			<br/>
			<div style="padding: 1em;background-color: #e9e9e9" class="ui-bar-c ui-corner-all ui-shadow">
				<label for="gridFornecedores"><b>Fornecedores/Cerimonial</b></label>
				<ul id="gridFornecedores" data-role="listview" data-filter-placeholder="Pesquisar..." data-inset="true">		
				</ul>
				<div id="divBtAdicionarFornecedor" style="display: none"><input width="100%" id="btnAdicionarFornecedor" onclick="" type="button" value="Adicionar" data-theme="b"/></div>
			</div>
			
			<br/>
			
			<div style="padding: 1em">			
				<label for="convite"><b>Convidar Amigos:</b></label>
				<input id="convite" name="email_r" maxlength="200" placeholder="Informe um e-mail" type="email" class="ui-bar-c" value=""/>
				<div width="100%" style="text-align: right;">
					<input type="button" value="Convidar" data-inline="true" data-theme="a" onclick="convidarAmigo()"/>
				</div>
			</div>
				
		</div>

		<!-- contentMain -->
</div> <!-- page1 -->
　
<!-- Page ends here -->
</body>

			<script>
			
		 	var perfil_;
		 	var idComissao;
		 	var nomeComissao;
		 	var situacao;
		 	var tipoMembro;
		 	var idFornecedorSelecionado;
		 	var acaoSelecionada;
		
			$(document).ready(
					function() {
						
						 $(".ui-content").css("padding","0em");
						
						var navigation = window.localStorage.getItem("herbiee_navigation");
						if(navigation != null){
						    var s = navigation;
						    iduser_ = s.substr(0,s.indexOf(';;;;'));
						    email_ = s.substr(s.indexOf(';;;;')+4,s.indexOf(',,,,')-(s.indexOf(';;;;')+4));
						    perfil_ = s.substr(s.indexOf(',,,,')+4,s.lentgh);
						}
						
						if(iduser_ == null || email_ == null  || perfil_ == null){
							$(window).attr('location','login.html?frommenu=1');
						}
						
						if(perfil_ != 4){
							$(window).attr('location','login.html?frommenu=1');
						}
						
						//Recupera param get
						(window.onpopstate = function () {
						    var match,
						        pl     = /\+/g,  // Regex for replacing addition symbol with a space
						        search = /([^&=]+)=?([^&]*)/g,
						        decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); },
						        query  = window.location.search.substring(1);
	
						    urlParams = {};
						    while (match = search.exec(query))
						       urlParams[decode(match[1])] = decode(match[2]);
						})();
						
						carregarComissao();
						
					});
		
			function carregarComissao() {

				$.mobile.loading("show");
				
				$.ajax({
					type : 'GET',
					url : "/apps/public/obterComissoes/"+email_+"/"+iduser_+"/projetoformar/4/0",
					dataType : 'json',
					success : function(data) {
						if (data.status == true) {
							list = data;
							$('#grid').empty();
							
							if(list.Comissao.length > 0){
									var img = '<img src="#"/>';
									if(list.Comissao[0].caminho_midia != null){
										$('#midia').css('background','url(\'uploads/' + list.Comissao[0].caminho_midia + '\') center center / 100%');
										img = '<div style="position: relative;width: 100%;height: 100px;background: url(\'uploads/' + list.Comissao[0].caminho_midia + '\') center center / 200%;"/>';
									}else{
										$('#midia').remove();
										img = '<div style="position: relative;width: 100px;height: 100px"/>';
									}
									
									var link = "";
									var linkClose = "";
									var linkIcon = "";
									
									link = '<a href="#" onclick="$(window).attr(\'location\', \'meusDadosComissao.html\')">';
									linkClose = '</a>';
									linkIcon = 'data-icon="edit"';
									$('#divBtAdicionarMembro').show();
									$('#divBtAdicionarMembro').attr('onclick','$(window).attr(\'location\', \'meusDadosComissao.html?add=1\')');
									$('#divBtAdicionarFornecedor').show();
									$('#divBtAdicionarFornecedor').attr('onclick','$(window).attr(\'location\', \'buscarFornecedorComissao.html?id='+list.Comissao[0].id_comissao+'\')');
									
									$('#grid').append('<li '+linkIcon+'>'+
															link+
																'<table width="100%">'+
																	'<tr>'+
																		'<td align="left" style="margin-left: 5px">'+
																			'<font color="black" size="5px" style="white-space: normal;">'+
																				'<b>' + list.Comissao[0].nome + '</b></td>'+
																	'</tr>'+
																	'<tr>'+															
																		'<td align="left">'+
																			'<font color="black" size="2px" style="white-space: normal;"><br/>Intituição: <b>' + list.Comissao[0].instituicao + '</b></font>'+
																		'</td>'+
																	'</tr>'+
																	'<tr>'+															
																		'<td align="left">'+
																			'<font color="black" size="2px" style="white-space: normal;">Curso: ' + list.Comissao[0].curso + '</font>'+
																		'</td>'+
																	'</tr>'+
																	'<tr>'+															
																		'<td align="left">'+
																			'<font color="black" size="2px" style="white-space: normal;">Telefone: ' + list.Comissao[0].telefone + '</font>'+
																		'</td>'+
																	'</tr>'+
																	'<tr>'+															
																		'<td align="left">'+
																			'<font color="black" size="2px" style="white-space: normal;">Criador: ' + list.Comissao[0].email + '</font>'+
																		'</td>'+
																	'</tr>'+
																'</table>'+
															linkClose+
														'</li>');
									
									nomeComissao = list.Comissao[0].nome;
									idComissao = list.Comissao[0].id_comissao;
									
									carregarMembros();
									carregarFornecedores();									
								
							}else{
								
								$('#midia').remove();
								
								$('#noticias').empty();									
								$('#noticias').append("<li><b>Não disponível</b></li>");
								$('#noticias').listview("refresh");									
								
								$('#gridMembros').empty();
								$('#gridMembros').append("<li><b>Não disponível</b></li>");
								$('#gridMembros').listview("refresh");									
								
								$('#gridFornecedores').empty();
								$('#gridFornecedores').append("<li><b>Não disponível</b></li>");
								$('#gridFornecedores').listview("refresh");									
							}
								
							$('#grid').listview("refresh");
							
							$.mobile.loading("hide");

						}

					},
					error : function() {
							$.mobile.loading("hide");
					}
				});
			}
			
			function carregarMembros(){
				
				$('#gridMembros').empty();
				
				for (i = 0; i < list.Comissao.length; i++) {
					
					var img = '<img src="#"/>';
					if(list.Comissao[i].midiaAluno != null){
						img = '<div style="position: relative;width: 100px;height: 100px;margin: -20px;background: url(\'uploads/' + list.Comissao[i].midiaAluno + '\') center center / 200%;"/>';
					}else{
						img = '<div style="position: relative;width: 100px;height: 100px;margin: -20px;background: url(\'img/semfoto.jpg\') center center / 100%;"/>';
					}
					
					var situacaoMembro = "";
					if(list.Comissao[i].situacao != 1){
						situacaoMembro = '<br/><font color="black" size="1px">(' + obterSituacaoAlunoNaComissao(list.Comissao[i].situacao) + ')</font>';
					}
					
					$('#gridMembros').append('<li>'+
											'<a href="#">'+
												'<table width="100%">'+
													'<tr>'+
														'<td align="left" width="84px" style="vertical-align: top">' + img + '<img src="img/pixel.png" width="84px" height="1px"/></td>'+
														'<td align="left" style="margin-left: 2px;">'+
															'<font color="black" size="3px" style="white-space: normal;">'+
																'<b>' + (list.Comissao[i].nomeAluno != null ? list.Comissao[i].nomeAluno : cutStringMobile(list.Comissao[i].emailMembro,"g")) + '</b></font><br/>'+
																'<font color="black" size="1px">' + (list.Comissao[i].nomeAluno != null ? cutStringMobile(list.Comissao[i].emailMembro,"p") : '') + '</font>'+
																situacaoMembro + '<br/>' +
																'<font color="black" size="1px">' + obterTipoAlunoNaComissao(list.Comissao[i].tipo) + '</font>'+
																'</td>'+
													'</tr>'+
												'</table>'+
											'</a>'+
										'</li>');
				}
				
				$('#gridMembros').listview("refresh");
				
			}
			
			function carregarFornecedores(){
				
				$.mobile.loading("show");
				
				$.ajax({
					type : 'GET',
					url : "/apps/public/obterFornecedorDaComissao/"+email_+"/"+iduser_+"/projetoformar/1/"+idComissao,
					dataType : 'json',
					success : function(data) {
						if (data.status == true) {
							list = data;
							$('#gridFornecedores').empty();
							for (i = 0; i < list.Fornecedor.length; i++) {									
								
								var img = '<img src="#"/>';
								if(list.Fornecedor[i].caminho_midia != null){
									img = '<div style="position: relative;width: 100px;height: 100px;margin: -20px;background: url(\'uploads/' + 
											list.Fornecedor[i].caminho_midia + '\') center center / 200%;"/>';
								}else{
									img = '<div style="position: relative;width: 100px;height: 100px;margin: -20px;background: url(\'img/semfoto.jpg\') center center / 100%;"/>';
								}
								if(list.Fornecedor[i].nomeTipoFornecedor == null)
									list.Fornecedor[i].nomeTipoFornecedor = "";
								
								var color = '';
								if(list.Fornecedor[i].cerimonial == 1)
									color = 'style="background-color: #69F0AE"';
								
								$('#gridFornecedores').append('<li style="background-color: #FF9800" data-icon="carat-d">'+
											'<a href="#" '+color+' onclick="exibirOcultarOpcoesFornecedor('+list.Fornecedor[i].id_fornecedor+','+list.Fornecedor[i].cerimonial+','+list.Fornecedor[i].atuar_como_presidente+','+list.Fornecedor[i].situacaoCF+')">'+
												'<table width="100%">'+
													'<tr height="85px">'+
														'<td align="left" width="100px" style="vertical-align: top">' + img + '</td>'+
														'<td align="left" style="margin-left: 5px">'+
															'<font color="black" size="5px" style="white-space: normal;">'+
																'<b>' + list.Fornecedor[i].nome + '</b><br/><div style="margin-left: -5px" id="rateYo_'+list.Fornecedor[i].id_fornecedor+'"></div>'+
																'<font color="black" size="2px" style="white-space: normal;">'+list.Fornecedor[i].nomeTipoFornecedor+'</font>'+
															'</font></td>'+
													'</tr>'+
													/* '<tr>'+															
														'<td colspan="2" align="left">'+
															'<font color="black" size="2px" style="white-space: normal;"><br/>CPF/CNPJ: ' + list.Fornecedor[i].identificacao + '</font>'+
														'</td>'+
													'</tr>'+														
													'<tr>'+															
														'<td colspan="2" align="left">'+
															'<font color="black" size="2px" style="white-space: normal;">' + list.Fornecedor[i].endereco + '</font>'+
														'</td>'+
													'</tr>'+														
													'<tr>'+															
														'<td colspan="2" align="left">'+
															'<font color="black" size="3px" style="white-space: normal;">Telefone: ' + list.Fornecedor[i].telefone + '</font>'+
														'</td>'+
													'</tr>'+
													'<tr>'+															
													'<td colspan="2" align="left">'+
														'<font color="black" size="3px" style="white-space: normal;">E-mail Vinculado: ' + (list.Fornecedor[i].email != null ? list.Fornecedor[i].email : 'N/A') + '</font>'+
													'</td>'+
													'</tr>'+ */
													'<tr>'+															
													'<td colspan="2" align="left">'+
														/* '<div id="divConcederPermissaoPresidente'+list.Fornecedor[i].id_fornecedor+'" style="display: none"><a data-role="button" data-theme="b" class="buttonWordWrap" onclick="concederPermissaoPresidente('+list.Fornecedor[i].id_fornecedor+',\''+list.Fornecedor[i].nome+'\')">Conceder permissão de presidente</a></div>'+
														'<div id="divConcedidoPermissaoPresidente'+list.Fornecedor[i].id_fornecedor+'" style="display: none"><a data-role="button" style="background-color: orange !important" class="buttonWordWrap" onclick="removerPermissaoPresidente('+list.Fornecedor[i].id_fornecedor+',\''+list.Fornecedor[i].nome+'\')">Cerimonial Ativo</a></div>'+ */
														'<div id="divConcedidoPermissaoPresidenteLabel'+list.Fornecedor[i].id_fornecedor+'" class="ui-bar-c ui-corner-all ui-shadow" style="padding: 1em;display: none; background-color: white;text-align: center;"><b>Cerimonial Ativo</b></div>'+
														'<div id="divFornecedorPendenteLabel'+list.Fornecedor[i].id_fornecedor+'" class="ui-bar-c ui-corner-all ui-shadow" style="padding: 1em;display: none; background-color: yellow;text-align: center;"><b>Pendente Aprovação</b></div>'+
													'</td>'+
													'</tr>'+														
												'</table>'+
											'</a>'+
											
											'<div id="opcoesFornecedor'+list.Fornecedor[i].id_fornecedor+'" style="display:none; padding: 1em;">'+
												'<div><a data-role="button" class="buttonWordWrap" onclick="detalharFornecedor('+list.Fornecedor[i].id_fornecedor+')">Detalhes</a></div>'+
												'<div id="divMensagem'+list.Fornecedor[i].id_fornecedor+'"><a data-role="button" class="buttonWordWrap" onclick="enviarMensagem('+list.Fornecedor[i].id_fornecedor+')">Enviar Mensagem</a></div>'+
												'<div id="divConcederPermissaoPresidente'+list.Fornecedor[i].id_fornecedor+'" style="display: none"><a data-role="button" class="buttonWordWrap" onclick="concederPermissaoPresidente('+list.Fornecedor[i].id_fornecedor+',\''+list.Fornecedor[i].nome+'\')">Conceder permissão de presidente</a></div>'+
												'<div id="divConcedidoPermissaoPresidente'+list.Fornecedor[i].id_fornecedor+'" style="display: none"><a data-role="button" class="buttonWordWrap" onclick="removerPermissaoPresidente('+list.Fornecedor[i].id_fornecedor+',\''+list.Fornecedor[i].nome+'\')">Remover permissão de presidente</a></div>'+
												'<div id="divIncluirNaLista'+list.Fornecedor[i].id_fornecedor+'" style="display: none"><a data-role="button" class="buttonWordWrap" onclick="incluirNaLista('+list.Fornecedor[i].id_fornecedor+',\''+list.Fornecedor[i].nome+'\')">Incluir na Lista (Aprovar)</a></div>'+
												'<div id="divAnexarDocumento'+list.Fornecedor[i].id_fornecedor+'" style="display: none"><a data-role="button" class="buttonWordWrap" onclick="anexarDocumento('+list.Fornecedor[i].id_fornecedor+')">Anexar Documentos</a></div>'+
												'<div id="divReuniao'+list.Fornecedor[i].id_fornecedor+'" style="display: none"><a data-role="button" class="buttonWordWrap" onclick="gerenciarReuniao('+list.Fornecedor[i].id_fornecedor+')">Reuniões</a></div>'+
												'<div id="divDespesas'+list.Fornecedor[i].id_fornecedor+'" style="display: none"><a data-role="button" class="buttonWordWrap" onclick="gerenciarDespesas('+list.Fornecedor[i].id_fornecedor+')">Despesas</a></div>'+
												'<div id="divRemoverFornecedor'+list.Fornecedor[i].id_fornecedor+'" style="display: none"><a data-role="button" class="buttonWordWrap" onclick="removerFornecedor('+list.Fornecedor[i].id_fornecedor+',\''+list.Fornecedor[i].nome+'\')">Remover</a></div>'+
											'</div>'+												
											
										'</li>'
								);
								
								if(list.Fornecedor[i].cerimonial == 1){
									if(list.Fornecedor[i].atuar_como_presidente == 1){
										$("#divConcedidoPermissaoPresidenteLabel"+list.Fornecedor[i].id_fornecedor).show();
									}/* else{
										$("#divConcederPermissaoPresidente"+list.Fornecedor[i].id_fornecedor).show();
									} */
								}
								
								if(list.Fornecedor[i].situacaoCF == 0){
									$("#divFornecedorPendenteLabel"+list.Fornecedor[i].id_fornecedor).show();
								}
								
								// TODO ---- REMOVER ISSO QUANDO AVALIAÇÃO OK
								var randomnumber = Math.floor(Math.random() * (5 - 0 + 1)) + 0;  
								
								$("#rateYo_"+list.Fornecedor[i].id_fornecedor).rateYo({
									    rating: randomnumber,
									    fullStar: true,
									    readOnly: true,
									    normalFill: "#cccccc",
									    ratedFill: "black",
									    starWidth: "20px"
								  });									
								
							}
							$("body").trigger("create");
							$('#gridFornecedores').listview("refresh");
							$.mobile.loading("hide");

						}

					},
					error : function(data) {
						
						if(data.status == 401)
							$(window).attr('location','login.html?frommenu=1');							
						
						$.mobile.loading("hide");
					}
				});
				
			}				

			function ingressarNaComissao(){
				
				$.mobile.loading("show");
				
				$.ajax({
					type : 'GET',
					url : "/apps/public/obterAluno/"+email_+"/"+iduser_+"/projetoformar/"+perfil_,
					dataType : 'json',
					success : function(data) {
						if (data.status == true) {
							list = data;
							if(list.Aluno.length == 0){
								
								alert('ACESSO NÃO AUTORIZADO!');
								
							}else{
								
								hideMain();

								hideContentTransition();

								$("#msgServer_2").empty();
								$("#msgServer_2").append("Será enviada uma solicitação de inclusão na comissão '"+nomeComissao+"' para os presidentes da Comissão. <br/><br/>Você será notificado em breve.");

								showContentDialogConfirmacao2();
								
								
							}

							$.mobile.loading("hide");

						}

					},
					error : function() {
							$.mobile.loading("hide");
					}
				});						

			}
			
			function confirmarIngressoComissao(){
				
				$.mobile.loading("show");
				
				$.ajax({
					type: 'POST',
					data: {"email" : email_, "iduser" : iduser_, "app" : "projetoformar", "perfil" : perfil_, "id" : idComissao},
					url: '/apps/public/ingressarComissao',
					dataType: 'json',
					success: function(data){
						
						hideContentDialogConfirmacao2();
						
					    hideMain();
					    
					    hideContentTransition();
					    
					    $("#msgServer").empty();
					    $("#msgServer").append(data);
					    
					    $.mobile.loading("hide");
					    
					    showContentDialog2();
						carregarComissao();
					    
					},
					error: function(data){
						
						hideContentDialogConfirmacao2();
					    
					    hideMain();
					    
					    hideContentTransition();
					    
					    $("#msgServer").empty();
					    $("#msgServer").append(data);
					    
					    $.mobile.loading("hide");
					    
					    showContentDialog2(data);						    
					    
					}
				});					
				
			}
			
			function concederPermissaoPresidente(idFornecedor, nome){
				
				acaoSelecionada = 0;
				
				idFornecedorSelecionado = idFornecedor;
								
				hideMain();

				hideContentTransition();

				$("#msgServer_1").empty();
				$("#msgServer_1").append("Confirma conceder para o cerimonial '"+nome+"' acesso de presidente na Comissão?");

				showContentDialogConfirmacao1();
				
			}
			
			function confirmarConcederPermissaoPresidente(){
				
				$.mobile.loading("show");
								
				$.ajax({
					type: 'POST',
					data: {"email" : email_, "iduser" : iduser_, "app" : "projetoformar", "perfil" : perfil_, "idComissao" : idComissao, "idFornecedor" : idFornecedorSelecionado},
					url: '/apps/public/concederPermissaoPresidente',
					dataType: 'json',
					success: function(data){
						
						hideContentDialogConfirmacao1();
						
					    hideMain();
					    
					    hideContentTransition();
					    
					    $("#msgServer").empty();
					    $("#msgServer").append(data);
					    
					    $.mobile.loading("hide");
					    
					    showContentDialog2();
					    carregarFornecedores();
					    
					},
					error: function(data){
						
						hideContentDialogConfirmacao1();
					    
						hideMain();
						hideContentTransition();
						$("#msgServerErro").empty();
						$("#msgServerErro").append(JSON.parse(data.responseText));
						$.mobile.loading("hide");
						showContentDialog();						    
					    
					}
				});	
				
			}
			
			function removerPermissaoPresidente(idFornecedor, nome){
				
				acaoSelecionada = 1;
				
				idFornecedorSelecionado = idFornecedor;
								
				hideMain();

				hideContentTransition();

				$("#msgServer_1").empty();
				$("#msgServer_1").append("Confirma remover o acesso de presidente para o cerimonial '"+nome+"'?");

				showContentDialogConfirmacao1();
				
			}
			
			function confirmarRemoverPermissaoPresidente(){
				
				$.mobile.loading("show");
				
				$.ajax({
					type: 'POST',
					data: {"email" : email_, "iduser" : iduser_, "app" : "projetoformar", "perfil" : perfil_, "idComissao" : idComissao, "idFornecedor" : idFornecedorSelecionado},
					url: '/apps/public/removerPermissaoPresidente',
					dataType: 'json',
					success: function(data){
						
						hideContentDialogConfirmacao1();
						
					    hideMain();
					    
					    hideContentTransition();
					    
					    $("#msgServer").empty();
					    $("#msgServer").append(data);
					    
					    $.mobile.loading("hide");
					    
					    showContentDialog2();
					    carregarFornecedores();
					    
					},
					error: function(data){
						
						hideContentDialogConfirmacao1();
					    
						hideMain();
						hideContentTransition();
						$("#msgServerErro").empty();
						$("#msgServerErro").append(JSON.parse(data.responseText));
						$.mobile.loading("hide");
						showContentDialog();						    
					    
					}
				});	
				
			}				
			
			function callBackTelaConfirmacao(){
				
				if(acaoSelecionada == 0){ // conceder permissao presidente
					confirmarConcederPermissaoPresidente();
				}else if(acaoSelecionada == 1){ // remover permissao presidente
					confirmarRemoverPermissaoPresidente();
				}else if(acaoSelecionada == 2){ // incluir na lista
					confirmarIncluirNaLista();
				}else if(acaoSelecionada == 3){ // remover fornecedor
					confirmarRemoverFornecedor();
				}
				
			}
			
			function exibirOcultarOpcoesFornecedor(idFornecedor, cerimonial, atuar_como_presidente, situacaoCF){
				if($('#opcoesFornecedor'+idFornecedor).is(':visible')){
					$('#opcoesFornecedor'+idFornecedor).hide();
				}else{
					$('#opcoesFornecedor'+idFornecedor).show();
				}
				
				if(cerimonial == 1 && situacaoCF == 1){
					if(atuar_como_presidente == 1){
						$("#divConcedidoPermissaoPresidente"+idFornecedor).show();
					}else{
						$("#divConcederPermissaoPresidente"+idFornecedor).show();
					}
				}
				
				if(situacaoCF == 0){
					$("#divIncluirNaLista"+idFornecedor).show();
				}else if(situacaoCF == 1){
					$("#divReuniao"+idFornecedor).show();	
					$("#divDespesas"+idFornecedor).show();	
					$("#divAnexarDocumento"+idFornecedor).show();	
				}
				
				$("#divRemoverFornecedor"+idFornecedor).show();
					
				
			}				
			
			function detalharFornecedor(idFornecedor){
				$(window).attr('location', 'detalheFornecedorComissao.html?idComissao='+idComissao+'&idFornecedor='+idFornecedor);
			} 
			
			function incluirNaLista(idFornecedor, nome){
				
				acaoSelecionada = 2;
				
				idFornecedorSelecionado = idFornecedor;
				
				hideMain();

				hideContentTransition();

				$("#msgServer_1").empty();
				$("#msgServer_1").append("Confirma incluir o fornecedor '"+nome+"' na lista de fornecedores da comissão?");

				showContentDialogConfirmacao1();					
				
			}
			
			function confirmarIncluirNaLista(){
				
				$.mobile.loading("show");
				
				$.ajax({
					type: 'POST',
					data: {"email" : email_, "iduser" : iduser_, "app" : "projetoformar", "perfil" : perfil_, "idComissao" : idComissao, "idFornecedor" : idFornecedorSelecionado},
					url: '/apps/public/incluirFornecedorNaLista',
					dataType: 'json',
					success: function(data){
						
						hideContentDialogConfirmacao1();
						
					    hideMain();
					    
					    hideContentTransition();
					    
					    $("#msgServer").empty();
					    $("#msgServer").append(data);
					    
					    $.mobile.loading("hide");
					    
					    showContentDialog2();
					    carregarFornecedores();
					    
					},
					error: function(data){
						
						hideContentDialogConfirmacao1();
					    
						hideMain();
						hideContentTransition();
						$("#msgServerErro").empty();
						$("#msgServerErro").append(JSON.parse(data.responseText));
						$.mobile.loading("hide");
						showContentDialog();						    
					    
					}
				});						
				
			}
			
			function removerFornecedor(idFornecedor, nome){
				
				acaoSelecionada = 3;
				
				idFornecedorSelecionado = idFornecedor;
				
				hideMain();

				hideContentTransition();

				$("#msgServer_1").empty();
				$("#msgServer_1").append("Confirma remover da lista de fornecedores da comissão o fornecedor '"+nome+"'?");

				showContentDialogConfirmacao1();					
				
			}
			
			function confirmarRemoverFornecedor(){
				
				$.mobile.loading("show");
				
				$.ajax({
					type: 'POST',
					data: {"email" : email_, "iduser" : iduser_, "app" : "projetoformar", "perfil" : perfil_, "idComissao" : idComissao, "idFornecedor" : idFornecedorSelecionado},
					url: '/apps/public/removerFornecedorDaLista',
					dataType: 'json',
					success: function(data){
						
						hideContentDialogConfirmacao1();
						
					    hideMain();
					    
					    hideContentTransition();
					    
					    $("#msgServer").empty();
					    $("#msgServer").append(data);
					    
					    $.mobile.loading("hide");
					    
					    showContentDialog2();
					    carregarFornecedores();
					    
					},
					error: function(data){
						
						hideContentDialogConfirmacao1();
					    
						hideMain();
						hideContentTransition();
						$("#msgServerErro").empty();
						$("#msgServerErro").append(JSON.parse(data.responseText));
						$.mobile.loading("hide");
						showContentDialog();						    
					    
					}
				});						
				
			}	
				
				function convidarAmigo(){
					
					var err = false;
					// Hide the Main content
					hideMain();

					// Reset the previously highlighted form elements
					inputMapVar.each(function(index) {
						$(this).prev().removeClass(MISSING);
					});

					// Perform form validation
					inputMapVar.each(function(index) {
						if ($(this).val() == null || $(this).val() == EMPTY) {
							$(this).prev().addClass(MISSING);
							err = true;
						}
					});

					// If validation fails, show Dialog content
					if (err == true) {
						$("#msgServerErro").empty();
						$("#msgServerErro").append("Por favor, preencha o e-mail.");					
						showContentDialog();
						return false;
					}

					// If validation passes, show Transition content
					showContentTransition();
					
					$.mobile.loading("show");
					
					$.ajax({
						type: 'POST',
						data: {"iduser" : iduser_, "emailConvidado" : $('#convite').val(), "email" : email_, "app" : "projetoformar"},
						url: '/apps/public/cadastrarUsuarioConvite',
						dataType: 'json',
						success: function(data){
							
						    hideMain();
						    
						    hideContentTransition();
						    
						    $("#msgServer").empty();
						    $("#msgServer").append(data);
						    
						    $.mobile.loading("hide");
						    
						    showContentDialog2();
						    
						    $('#convite').val("");
						    
						},
						error: function(data){
						    
						    hideMain();
						    
						    hideContentTransition();
						    
						    $("#msgServerErro").empty();
						    $("#msgServerErro").append(JSON.parse(data.responseText));
						    
						    $.mobile.loading("hide");
						    
						    showContentDialog();						    
						    
						}
					});						
					
				}					
			</script>
			
			<script src="js/jsGeral.js"></script>
			<script src="js/jsCadastros.js"></script>	
</html>